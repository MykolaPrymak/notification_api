/* Copyright 2014 Mykola Prymak. FreeBSD of MIT license */
(function(c){function e(){var a;if(Notification.permission)a=Notification.permission;else{var b=new Notification("notification:default");a=b.permission;setTimeout(function(){b.close()},10)}a=a.toLowerCase();f!=a&&$(document).trigger({type:"notification:permission",permission:a});return a}function d(a){a.type="notification:"+a.type;$(document).trigger(a)}if(!c.Notification)return c.Notify=function(a){},!1;var f;$(document).ready(function(){setTimeout(function(){"default"===e()&&$(document).trigger("notification:request")}, 1)});$(document).on("notification:permission",function(a){c.Notify.permission=f=a.permission});$(document).on("notification:request",function(){Notification.requestPermission(function(a){$(document).trigger({type:"notification:permission",permission:a})})});c.Notify=function(a,b){a&&a.substr&&(a={title:a});b=$.extend({timeout:5},a||{},b||{});"default"===e()&&$(document).trigger("notification:request");if(!b.title)return!1;var c=new Notification(b.title,b);b.defaultClose&&!b.click&&(b.click=c.close); $(c).on("show",function(a){0!==b.timeout&&setTimeout(function(){c.close()},1E3*b.timeout);d(a)}).on("click",function(a){try{b.click&&b.click(a)}catch(c){}d(a)}).on("close",d).on("error",function(a){});return c}})(window);